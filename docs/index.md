---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "HPCR Provider"
description: |-
  Terraform provider for IBM Hyper Protect confidential computing platforms. Built on the contract-go library, this provider automates the generation of encrypted and signed contracts for secure enclaves across HPVS, HPCR4RHVS, and HPCC platforms.
---

# HPCR Provider

Terraform provider for IBM Hyper Protect confidential computing platforms. Built on the [contract-go library](https://github.com/ibm-hyper-protect/contract-go), this provider automates the generation of encrypted and signed contracts for secure enclaves across HPVS, HPCR4RHVS, and HPCC platforms.

## Overview

IBM Hyper Protect services provide confidential computing capabilities that protect data in use by leveraging the Secure Execution feature of IBM Z and LinuxONE. This Terraform provider enables infrastructure-as-code management of Hyper Protect workloads by automating contract generation, encryption operations, and image selection.

## Supported Platforms

- **HPVS**: Hyper Protect Virtual Servers - Confidential computing VMs on IBM Cloud
- **HPCR4RHVS**: Hyper Protect Container Runtime for Red Hat Virtualization - Docker containers in secure enclaves
- **HPCC-PeerPod**: Hyper Protect Confidential Container Peer Pods - Kubernetes confidential computing for OpenShift

## Requirements

- [Terraform](https://www.terraform.io/downloads) 0.13 or later
- [OpenSSL](https://www.openssl.org/) binary (not LibreSSL) for encryption operations
  - **Linux**: `apt-get install openssl`
  - **macOS**: `brew install openssl`
  - **Windows**: Download from [Win32OpenSSL](https://slproweb.com/products/Win32OpenSSL.html)

### Optional: Custom OpenSSL Path

If OpenSSL is not in your system PATH, set the `OPENSSL_BIN` environment variable:

```bash
# Linux/macOS
export OPENSSL_BIN=/usr/bin/openssl

# Windows (PowerShell)
$env:OPENSSL_BIN="C:\Program Files\OpenSSL-Win64\bin\openssl.exe"
```

## Example Usage

```terraform
terraform {
  required_providers {
    hpcr = {
      source  = "ibm-hyper-protect/hpcr"
      version = ">= 1.2.0"
    }
  }
}

provider "hpcr" {}

# Create TGZ archive from docker-compose folder
resource "hpcr_tgz" "compose" {
  folder = "./docker-compose"
}

# Encrypt workload section
resource "hpcr_text_encrypted" "workload" {
  text = yamlencode({
    "compose" : {
      "archive" : resource.hpcr_tgz.compose.rendered
    }
  })
}

# Select HPCR image from IBM Cloud
data "ibm_is_images" "hyper_protect_images" {
  visibility = "public"
  status     = "available"
}

data "hpcr_image" "selected_image" {
  images = jsonencode(data.ibm_is_images.hyper_protect_images.images)
  spec   = ">=1.1.0"
}

# Generate encrypted contract
locals {
  contract = yamlencode({
    "env" : {
      "type" : "env",
      "logging" : {
        "logDNA" : {
          "hostname" : "syslog-a.example.com",
          "ingestionKey" : "your-key"
        }
      }
    },
    "workload" : {
      "type" : "workload",
      "compose" : {
        "archive" : resource.hpcr_tgz.compose.rendered
      }
    }
  })
}

resource "hpcr_contract_encrypted" "contract" {
  contract = local.contract
}
```

## Documentation

- [Terraform Registry Documentation](https://registry.terraform.io/providers/ibm-hyper-protect/hpcr/latest/docs)
- [Contract-Go User Documentation](https://ibm-hyper-protect.github.io/contract-go)
- [Confidential computing with LinuxONE](https://cloud.ibm.com/docs/vpc?topic=vpc-about-se)
- [IBM Hyper Protect Virtual Servers](https://www.ibm.com/docs/en/hpvs/2.2.x)
- [IBM Hyper Protect Confidential Container](https://www.ibm.com/docs/en/hpcc/1.1.x)
- [IBM Hyper Protect Confidential Container for Red Hat OpenShift](https://www.ibm.com/docs/en/hpcc/1.1.x)
