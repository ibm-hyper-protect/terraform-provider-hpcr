---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "hpcr_encryption_cert Data Source - hpcr"
subcategory: ""
description: |-
  Selects the best matching encryption certificate from a map based on semantic versioning constraints.
---

# hpcr_encryption_cert (Data Source)

Selects the best matching encryption certificate from a map of version-to-certificate entries based on semantic versioning constraints. This data source is typically used in combination with `hpcr_encryption_certs` to select a specific certificate version for contract encryption.

## How It Works

This data source:

1. **Accepts Certificate Map**: Takes a map where keys are version numbers and values are PEM-formatted certificates
2. **Applies Constraints**: Filters certificates based on the `spec` parameter (semantic version constraint)
3. **Selects Best Match**: Returns the highest version that matches the constraint
4. **Validates Certificate**: Uses the contract-go library to validate and retrieve the certificate

## Example Usage

```terraform
# Download available encryption certificates
data "hpcr_encryption_certs" "available" {
  versions = ["1.0.10", "1.0.11", "1.0.12"]
}

# Select the latest certificate
data "hpcr_encryption_cert" "latest" {
  certs = data.hpcr_encryption_certs.available.certs
  # spec defaults to "*" (latest)
}

# Use the selected certificate
resource "hpcr_contract_encrypted" "contract" {
  contract = yamlencode({
    "workload" : "...",
    "env" : "..."
  })
  cert = data.hpcr_encryption_cert.latest.cert
}

output "selected_version" {
  value = data.hpcr_encryption_cert.latest.version
}
```

## Example with Version Constraint

```terraform
# Download available certificates
data "hpcr_encryption_certs" "available" {
  versions = ["1.0.8", "1.0.9", "1.0.10", "1.0.11"]
}

# Select a specific version range
data "hpcr_encryption_cert" "stable" {
  certs = data.hpcr_encryption_certs.available.certs
  spec  = "~1.0.9"  # Version 1.0.x where x >= 9
}

# Select exact version
data "hpcr_encryption_cert" "specific" {
  certs = data.hpcr_encryption_certs.available.certs
  spec  = "1.0.10"
}
```

## Semantic Version Constraints

The `spec` parameter supports standard semantic version constraints:

- `*` or omitted - Latest version (default)
- `1.0.10` - Exact version
- `>=1.0.10` - Version 1.0.10 or higher
- `~1.0.10` - Version 1.0.x (patch releases from 1.0.10)
- `^1.0.0` - Version 1.x.x (minor and patch releases)
- `>=1.0.8 <1.0.12` - Range between versions

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `certs` (Map of String) Map of certificates from version to certificate content

### Optional

- `spec` (String) Semantic version range defining the HPCR certificate. Defaults to '*' (latest).

### Read-Only

- `cert` (String) Selected certificate content
- `id` (String) Data source identifier
- `version` (String) Version number of the selected certificate
